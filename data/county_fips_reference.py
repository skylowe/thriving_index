"""
County FIPS Code Reference

Maps county names to 5-digit FIPS codes for all target states.
Used for matching FBI UCR agency data to counties.

Format: 'COUNTY NAME': 'SSCCC' where:
  SS = 2-digit state FIPS
  CCC = 3-digit county FIPS

Note: Independent cities in Virginia are included with county codes.
"""

# Virginia (State FIPS: 51)
VIRGINIA_COUNTIES = {
    # Counties
    'ACCOMACK': '51001',
    'ALBEMARLE': '51003',
    'ALLEGHANY': '51005',
    'AMELIA': '51007',
    'AMHERST': '51009',
    'APPOMATTOX': '51011',
    'ARLINGTON': '51013',
    'AUGUSTA': '51015',
    'BATH': '51017',
    'BEDFORD': '51019',
    'BLAND': '51021',
    'BOTETOURT': '51023',
    'BRUNSWICK': '51025',
    'BUCHANAN': '51027',
    'BUCKINGHAM': '51029',
    'CAMPBELL': '51031',
    'CAROLINE': '51033',
    'CARROLL': '51035',
    'CHARLES CITY': '51036',
    'CHARLOTTE': '51037',
    'CHESTERFIELD': '51041',
    'CLARKE': '51043',
    'CRAIG': '51045',
    'CULPEPER': '51047',
    'CUMBERLAND': '51049',
    'DICKENSON': '51051',
    'DINWIDDIE': '51053',
    'ESSEX': '51057',
    'FAIRFAX': '51059',
    'FAUQUIER': '51061',
    'FLOYD': '51063',
    'FLUVANNA': '51065',
    'FRANKLIN': '51067',
    'FREDERICK': '51069',
    'GILES': '51071',
    'GLOUCESTER': '51073',
    'GOOCHLAND': '51075',
    'GRAYSON': '51077',
    'GREENE': '51079',
    'GREENSVILLE': '51081',
    'HALIFAX': '51083',
    'HANOVER': '51085',
    'HENRICO': '51087',
    'HENRY': '51089',
    'HIGHLAND': '51091',
    'ISLE OF WIGHT': '51093',
    'JAMES CITY': '51095',
    'KING AND QUEEN': '51097',
    'KING GEORGE': '51099',
    'KING WILLIAM': '51101',
    'LANCASTER': '51103',
    'LEE': '51105',
    'LOUDOUN': '51107',
    'LOUISA': '51109',
    'LUNENBURG': '51111',
    'MADISON': '51113',
    'MATHEWS': '51115',
    'MECKLENBURG': '51117',
    'MIDDLESEX': '51119',
    'MONTGOMERY': '51121',
    'NELSON': '51125',
    'NEW KENT': '51127',
    'NORTHAMPTON': '51131',
    'NORTHUMBERLAND': '51133',
    'NOTTOWAY': '51135',
    'ORANGE': '51137',
    'PAGE': '51139',
    'PATRICK': '51141',
    'PITTSYLVANIA': '51143',
    'POWHATAN': '51145',
    'PRINCE EDWARD': '51147',
    'PRINCE GEORGE': '51149',
    'PRINCE WILLIAM': '51153',
    'PULASKI': '51155',
    'RAPPAHANNOCK': '51157',
    'RICHMOND': '51159',
    'ROANOKE': '51161',
    'ROCKBRIDGE': '51163',
    'ROCKINGHAM': '51165',
    'RUSSELL': '51167',
    'SCOTT': '51169',
    'SHENANDOAH': '51171',
    'SMYTH': '51173',
    'SOUTHAMPTON': '51175',
    'SPOTSYLVANIA': '51177',
    'STAFFORD': '51179',
    'SURRY': '51181',
    'SUSSEX': '51183',
    'TAZEWELL': '51185',
    'WARREN': '51187',
    'WASHINGTON': '51191',
    'WESTMORELAND': '51193',
    'WISE': '51195',
    'WYTHE': '51197',
    'YORK': '51199',

    # Independent Cities (use city FIPS codes)
    'ALEXANDRIA': '51510',
    'BRISTOL': '51520',
    'BUENA VISTA': '51530',
    'CHARLOTTESVILLE': '51540',
    'CHESAPEAKE': '51550',
    'COLONIAL HEIGHTS': '51570',
    'COVINGTON': '51580',
    'DANVILLE': '51590',
    'EMPORIA': '51595',
    'FAIRFAX': '51600',
    'FALLS CHURCH': '51610',
    'FRANKLIN': '51620',
    'FREDERICKSBURG': '51630',
    'GALAX': '51640',
    'HAMPTON': '51650',
    'HARRISONBURG': '51660',
    'HOPEWELL': '51670',
    'LEXINGTON': '51678',
    'LYNCHBURG': '51680',
    'MANASSAS': '51683',
    'MANASSAS PARK': '51685',
    'MARTINSVILLE': '51690',
    'NEWPORT NEWS': '51700',
    'NORFOLK': '51710',
    'NORTON': '51720',
    'PETERSBURG': '51730',
    'POQUOSON': '51735',
    'PORTSMOUTH': '51740',
    'RADFORD': '51750',
    'RICHMOND': '51760',
    'ROANOKE': '51770',
    'SALEM': '51775',
    'STAUNTON': '51790',
    'SUFFOLK': '51800',
    'VIRGINIA BEACH': '51810',
    'WAYNESBORO': '51820',
    'WILLIAMSBURG': '51830',
    'WINCHESTER': '51840',
}

# Maryland (State FIPS: 24)
MARYLAND_COUNTIES = {
    'ALLEGANY': '24001',
    'ANNE ARUNDEL': '24003',
    'BALTIMORE': '24005',
    'CALVERT': '24009',
    'CAROLINE': '24011',
    'CARROLL': '24013',
    'CECIL': '24015',
    'CHARLES': '24017',
    'DORCHESTER': '24019',
    'FREDERICK': '24021',
    'GARRETT': '24023',
    'HARFORD': '24025',
    'HOWARD': '24027',
    'KENT': '24029',
    'MONTGOMERY': '24031',
    'PRINCE GEORGES': '24033',
    "PRINCE GEORGE'S": '24033',  # Alternative spelling
    'QUEEN ANNES': '24035',
    "QUEEN ANNE'S": '24035',  # Alternative spelling
    'SOMERSET': '24039',
    'ST. MARYS': '24037',
    "ST. MARY'S": '24037',  # Alternative spelling
    'TALBOT': '24041',
    'WASHINGTON': '24043',
    'WICOMICO': '24045',
    'WORCESTER': '24047',
    'BALTIMORE CITY': '24510',
}

# West Virginia (State FIPS: 54)
WEST_VIRGINIA_COUNTIES = {
    'BARBOUR': '54001',
    'BERKELEY': '54003',
    'BOONE': '54005',
    'BRAXTON': '54007',
    'BROOKE': '54009',
    'CABELL': '54011',
    'CALHOUN': '54013',
    'CLAY': '54015',
    'DODDRIDGE': '54017',
    'FAYETTE': '54019',
    'GILMER': '54021',
    'GRANT': '54023',
    'GREENBRIER': '54025',
    'HAMPSHIRE': '54027',
    'HANCOCK': '54029',
    'HARDY': '54031',
    'HARRISON': '54033',
    'JACKSON': '54035',
    'JEFFERSON': '54037',
    'KANAWHA': '54039',
    'LEWIS': '54041',
    'LINCOLN': '54043',
    'LOGAN': '54045',
    'MCDOWELL': '54047',
    'MARION': '54049',
    'MARSHALL': '54051',
    'MASON': '54053',
    'MERCER': '54055',
    'MINERAL': '54057',
    'MINGO': '54059',
    'MONONGALIA': '54061',
    'MONROE': '54063',
    'MORGAN': '54065',
    'NICHOLAS': '54067',
    'OHIO': '54069',
    'PENDLETON': '54071',
    'PLEASANTS': '54073',
    'POCAHONTAS': '54075',
    'PRESTON': '54077',
    'PUTNAM': '54079',
    'RALEIGH': '54081',
    'RANDOLPH': '54083',
    'RITCHIE': '54085',
    'ROANE': '54087',
    'SUMMERS': '54089',
    'TAYLOR': '54091',
    'TUCKER': '54093',
    'TYLER': '54095',
    'UPSHUR': '54097',
    'WAYNE': '54099',
    'WEBSTER': '54101',
    'WETZEL': '54103',
    'WIRT': '54105',
    'WOOD': '54107',
    'WYOMING': '54109',
}

# North Carolina (State FIPS: 37)
NORTH_CAROLINA_COUNTIES = {
    'ALAMANCE': '37001',
    'ALEXANDER': '37003',
    'ALLEGHANY': '37005',
    'ANSON': '37007',
    'ASHE': '37009',
    'AVERY': '37011',
    'BEAUFORT': '37013',
    'BERTIE': '37015',
    'BLADEN': '37017',
    'BRUNSWICK': '37019',
    'BUNCOMBE': '37021',
    'BURKE': '37023',
    'CABARRUS': '37025',
    'CALDWELL': '37027',
    'CAMDEN': '37029',
    'CARTERET': '37031',
    'CASWELL': '37033',
    'CATAWBA': '37035',
    'CHATHAM': '37037',
    'CHEROKEE': '37039',
    'CHOWAN': '37041',
    'CLAY': '37043',
    'CLEVELAND': '37045',
    'COLUMBUS': '37047',
    'CRAVEN': '37049',
    'CUMBERLAND': '37051',
    'CURRITUCK': '37053',
    'DARE': '37055',
    'DAVIDSON': '37057',
    'DAVIE': '37059',
    'DUPLIN': '37061',
    'DURHAM': '37063',
    'EDGECOMBE': '37065',
    'FORSYTH': '37067',
    'FRANKLIN': '37069',
    'GASTON': '37071',
    'GATES': '37073',
    'GRAHAM': '37075',
    'GRANVILLE': '37077',
    'GREENE': '37079',
    'GUILFORD': '37081',
    'HALIFAX': '37083',
    'HARNETT': '37085',
    'HAYWOOD': '37087',
    'HENDERSON': '37089',
    'HERTFORD': '37091',
    'HOKE': '37093',
    'HYDE': '37095',
    'IREDELL': '37097',
    'JACKSON': '37099',
    'JOHNSTON': '37101',
    'JONES': '37103',
    'LEE': '37105',
    'LENOIR': '37107',
    'LINCOLN': '37109',
    'MACON': '37113',
    'MADISON': '37115',
    'MARTIN': '37117',
    'MCDOWELL': '37111',
    'MECKLENBURG': '37119',
    'MITCHELL': '37121',
    'MONTGOMERY': '37123',
    'MOORE': '37125',
    'NASH': '37127',
    'NEW HANOVER': '37129',
    'NORTHAMPTON': '37131',
    'ONSLOW': '37133',
    'ORANGE': '37135',
    'PAMLICO': '37137',
    'PASQUOTANK': '37139',
    'PENDER': '37141',
    'PERQUIMANS': '37143',
    'PERSON': '37145',
    'PITT': '37147',
    'POLK': '37149',
    'RANDOLPH': '37151',
    'RICHMOND': '37153',
    'ROBESON': '37155',
    'ROCKINGHAM': '37157',
    'ROWAN': '37159',
    'RUTHERFORD': '37161',
    'SAMPSON': '37163',
    'SCOTLAND': '37165',
    'STANLY': '37167',
    'STOKES': '37169',
    'SURRY': '37171',
    'SWAIN': '37173',
    'TRANSYLVANIA': '37175',
    'TYRRELL': '37177',
    'UNION': '37179',
    'VANCE': '37181',
    'WAKE': '37183',
    'WARREN': '37185',
    'WASHINGTON': '37187',
    'WATAUGA': '37189',
    'WAYNE': '37191',
    'WILKES': '37193',
    'WILSON': '37195',
    'YADKIN': '37197',
    'YANCEY': '37199',
}

# Tennessee (State FIPS: 47)
TENNESSEE_COUNTIES = {
    'ANDERSON': '47001',
    'BEDFORD': '47003',
    'BENTON': '47005',
    'BLEDSOE': '47007',
    'BLOUNT': '47009',
    'BRADLEY': '47011',
    'CAMPBELL': '47013',
    'CANNON': '47015',
    'CARROLL': '47017',
    'CARTER': '47019',
    'CHEATHAM': '47021',
    'CHESTER': '47023',
    'CLAIBORNE': '47025',
    'CLAY': '47027',
    'COCKE': '47029',
    'COFFEE': '47031',
    'CROCKETT': '47033',
    'CUMBERLAND': '47035',
    'DAVIDSON': '47037',
    'DECATUR': '47039',
    'DEKALB': '47041',
    'DICKSON': '47043',
    'DYER': '47045',
    'FAYETTE': '47047',
    'FENTRESS': '47049',
    'FRANKLIN': '47051',
    'GIBSON': '47053',
    'GILES': '47055',
    'GRAINGER': '47057',
    'GREENE': '47059',
    'GRUNDY': '47061',
    'HAMBLEN': '47063',
    'HAMILTON': '47065',
    'HANCOCK': '47067',
    'HARDEMAN': '47069',
    'HARDIN': '47071',
    'HAWKINS': '47073',
    'HAYWOOD': '47075',
    'HENDERSON': '47077',
    'HENRY': '47079',
    'HICKMAN': '47081',
    'HOUSTON': '47083',
    'HUMPHREYS': '47085',
    'JACKSON': '47087',
    'JEFFERSON': '47089',
    'JOHNSON': '47091',
    'KNOX': '47093',
    'LAKE': '47095',
    'LAUDERDALE': '47097',
    'LAWRENCE': '47099',
    'LEWIS': '47101',
    'LINCOLN': '47103',
    'LOUDON': '47105',
    'MACON': '47111',
    'MADISON': '47113',
    'MARION': '47115',
    'MARSHALL': '47117',
    'MAURY': '47119',
    'MCMINN': '47107',
    'MCNAIRY': '47109',
    'MEIGS': '47121',
    'MONROE': '47123',
    'MONTGOMERY': '47125',
    'MOORE': '47127',
    'MORGAN': '47129',
    'OBION': '47131',
    'OVERTON': '47133',
    'PERRY': '47135',
    'PICKETT': '47137',
    'POLK': '47139',
    'PUTNAM': '47141',
    'RHEA': '47143',
    'ROANE': '47145',
    'ROBERTSON': '47147',
    'RUTHERFORD': '47149',
    'SCOTT': '47151',
    'SEQUATCHIE': '47153',
    'SEVIER': '47155',
    'SHELBY': '47157',
    'SMITH': '47159',
    'STEWART': '47161',
    'SULLIVAN': '47163',
    'SUMNER': '47165',
    'TIPTON': '47167',
    'TROUSDALE': '47169',
    'UNICOI': '47171',
    'UNION': '47173',
    'VAN BUREN': '47175',
    'WARREN': '47177',
    'WASHINGTON': '47179',
    'WAYNE': '47181',
    'WEAKLEY': '47183',
    'WHITE': '47185',
    'WILLIAMSON': '47187',
    'WILSON': '47189',
}

# Kentucky (State FIPS: 21)
KENTUCKY_COUNTIES = {
    'ADAIR': '21001',
    'ALLEN': '21003',
    'ANDERSON': '21005',
    'BALLARD': '21007',
    'BARREN': '21009',
    'BATH': '21011',
    'BELL': '21013',
    'BOONE': '21015',
    'BOURBON': '21017',
    'BOYD': '21019',
    'BOYLE': '21021',
    'BRACKEN': '21023',
    'BREATHITT': '21025',
    'BRECKINRIDGE': '21027',
    'BULLITT': '21029',
    'BUTLER': '21031',
    'CALDWELL': '21033',
    'CALLOWAY': '21035',
    'CAMPBELL': '21037',
    'CARLISLE': '21039',
    'CARROLL': '21041',
    'CARTER': '21043',
    'CASEY': '21045',
    'CHRISTIAN': '21047',
    'CLARK': '21049',
    'CLAY': '21051',
    'CLINTON': '21053',
    'CRITTENDEN': '21055',
    'CUMBERLAND': '21057',
    'DAVIESS': '21059',
    'EDMONSON': '21061',
    'ELLIOTT': '21063',
    'ESTILL': '21065',
    'FAYETTE': '21067',
    'FLEMING': '21069',
    'FLOYD': '21071',
    'FRANKLIN': '21073',
    'FULTON': '21075',
    'GALLATIN': '21077',
    'GARRARD': '21079',
    'GRANT': '21081',
    'GRAVES': '21083',
    'GRAYSON': '21085',
    'GREEN': '21087',
    'GREENUP': '21089',
    'HANCOCK': '21091',
    'HARDIN': '21093',
    'HARLAN': '21095',
    'HARRISON': '21097',
    'HART': '21099',
    'HENDERSON': '21101',
    'HENRY': '21103',
    'HICKMAN': '21105',
    'HOPKINS': '21107',
    'JACKSON': '21109',
    'JEFFERSON': '21111',
    'JESSAMINE': '21113',
    'JOHNSON': '21115',
    'KENTON': '21117',
    'KNOTT': '21119',
    'KNOX': '21121',
    'LARUE': '21123',
    'LAUREL': '21125',
    'LAWRENCE': '21127',
    'LEE': '21129',
    'LESLIE': '21131',
    'LETCHER': '21133',
    'LEWIS': '21135',
    'LINCOLN': '21137',
    'LIVINGSTON': '21139',
    'LOGAN': '21141',
    'LYON': '21143',
    'MCCRACKEN': '21145',
    'MCCREARY': '21147',
    'MCLEAN': '21149',
    'MADISON': '21151',
    'MAGOFFIN': '21153',
    'MARION': '21155',
    'MARSHALL': '21157',
    'MARTIN': '21159',
    'MASON': '21161',
    'MEADE': '21163',
    'MENIFEE': '21165',
    'MERCER': '21167',
    'METCALFE': '21169',
    'MONROE': '21171',
    'MONTGOMERY': '21173',
    'MORGAN': '21175',
    'MUHLENBERG': '21177',
    'NELSON': '21179',
    'NICHOLAS': '21181',
    'OHIO': '21183',
    'OLDHAM': '21185',
    'OWEN': '21187',
    'OWSLEY': '21189',
    'PENDLETON': '21191',
    'PERRY': '21193',
    'PIKE': '21195',
    'POWELL': '21197',
    'PULASKI': '21199',
    'ROBERTSON': '21201',
    'ROCKCASTLE': '21203',
    'ROWAN': '21205',
    'RUSSELL': '21207',
    'SCOTT': '21209',
    'SHELBY': '21211',
    'SIMPSON': '21213',
    'SPENCER': '21215',
    'TAYLOR': '21217',
    'TODD': '21219',
    'TRIGG': '21221',
    'TRIMBLE': '21223',
    'UNION': '21225',
    'WARREN': '21227',
    'WASHINGTON': '21229',
    'WAYNE': '21231',
    'WEBSTER': '21233',
    'WHITLEY': '21235',
    'WOLFE': '21237',
    'WOODFORD': '21239',
}

# District of Columbia (State FIPS: 11)
DC_COUNTIES = {
    'DISTRICT OF COLUMBIA': '11001',
    'WASHINGTON': '11001',  # Alternative name
}

# Combined dictionary for all states
ALL_COUNTIES = {
    **VIRGINIA_COUNTIES,
    **MARYLAND_COUNTIES,
    **WEST_VIRGINIA_COUNTIES,
    **NORTH_CAROLINA_COUNTIES,
    **TENNESSEE_COUNTIES,
    **KENTUCKY_COUNTIES,
    **DC_COUNTIES,
}

# State-specific dictionaries for lookup
COUNTIES_BY_STATE = {
    'VA': VIRGINIA_COUNTIES,
    'MD': MARYLAND_COUNTIES,
    'WV': WEST_VIRGINIA_COUNTIES,
    'NC': NORTH_CAROLINA_COUNTIES,
    'TN': TENNESSEE_COUNTIES,
    'KY': KENTUCKY_COUNTIES,
    'DC': DC_COUNTIES,
}


def get_county_fips(county_name: str, state_abbr: str) -> str:
    """
    Get FIPS code for a county.

    Args:
        county_name: County name (without 'County' suffix)
        state_abbr: State abbreviation (e.g., 'VA', 'MD')

    Returns:
        5-digit FIPS code or None if not found
    """
    if state_abbr not in COUNTIES_BY_STATE:
        return None

    # Normalize county name
    normalized = county_name.strip().upper()

    # Remove common suffixes
    for suffix in [' COUNTY', ' PARISH', ' CITY', ' BOROUGH']:
        if normalized.endswith(suffix):
            normalized = normalized[:-len(suffix)].strip()

    return COUNTIES_BY_STATE[state_abbr].get(normalized)


def get_all_fips_for_state(state_abbr: str) -> dict:
    """
    Get all county FIPS codes for a state.

    Args:
        state_abbr: State abbreviation

    Returns:
        Dictionary mapping county names to FIPS codes
    """
    return COUNTIES_BY_STATE.get(state_abbr, {})
